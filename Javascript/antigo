<?php
	$select = $_POST['selectopcao'];
	function escreveLinha($numero, $row){
		//Cabeçalho
		if($numero == 1){
			echo "<table>
			<tr>
			<th colspan='1' id='head'>Número</th>
			<th colspan='1' width=40% id='head'>Mandante</th>
			<th colspan='1' width=20% id='head'>Placar</th>
			<th colspan='1' width=40% id='head'>Visitante</th>
			</tr>"";
			}
			//Tirando espaços do nome do adversário (para combinar com nomes dos escudos)
			$escudo = str_replace(' ', '', utf8_encode($row["adversario"]));
			//Colocando data dd-mm-yyyy
			$date = new DateTime($row["dataJogo"]);
			//Checando se o id é par ou ímpar pra trocar as cores
			if($numero%2==0){
			$cor = "#232830";
			}else{
			$cor = "black";
		}
		return "<tr><th colspan=1 rowspan=2 style=background-color:$cor>" . $numero . "</th>" ."<th colspan=1 style='background-color: white; border-bottom:  1px solid'><img src=index_files/Botafogo.png width=70 height=70 alt=Imagem /></th>"."<th colspan=1 style=background-color:$cor>Botafogo</th>"."<th colspan=1 rowspan=2 style=background-color:$cor>" . utf8_encode($row["golsBotafogo"]) ." x ". utf8_encode($row["golsAdversario"]) . "</th>". "<th colspan=1 style='background-color: white; border-bottom:  1px solid'><img src=index_files/$escudo.png width=70 height=70 alt=Imagem /></th>" ."<th colspan=1 style=background-color:$cor>"
		. utf8_encode($row["adversario"]). "</th>"
		."<th colspan=1 style=background-color:$cor>" . utf8_encode($row["campeonato"]) . "</th>"
		."<th colspan=1 style=background-color:$cor>" . $date -> format( 'd-m-Y' ) . "</th>"
		."<th colspan=1 style=background-color:$cor>" . "Estádio ". utf8_encode($row["estadio"]) . "</th>"."</tr>"."<tr><th colspan=2 style='text-align:left; vertical-align: text-top;background-color:$cor'>". utf8_encode($row["autorBotafogo"]) ."</th><th colspan=2 style='text-align:left; vertical-align: text-top;background-color:$cor'>". utf8_encode($row["autorAdversario"]) ."</th>"."<th colspan=3 style=background-color:$cor>Técnico: " . utf8_encode($row["tecnico"]) . "</th></tr>";
	}
	$conn = mysqli_connect("localhost", "root", "", "jogos");
	// Checando conexão
	if ($conn->connect_error) {
		die("Connection failed: " . $conn->connect_error);
	} 
	$sql = "SELECT * FROM jogo";
	$result = $conn->query($sql);
	if ($result->num_rows > 0) {
		$numero = 0; //número de jogos
		// Mostrando as informações em cada linha
		while($row = $result->fetch_assoc()) {
			//echo escreveLinha($numero, $row);
			switch($select){
				case "todos":
				$numero = $numero + 1;
				echo escreveLinha($numero, $row);
				break;
				case "adversario":
				$inserido = $_POST['adv'];
				if($inserido == utf8_encode($row["adversario"])){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "campeonato":
				$inserido = $_POST['camp'];
				if($inserido == utf8_encode($row["campeonato"])){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "data":
				$inserido = $_POST['data']; //2014-08-31
				if($inserido == utf8_encode($row["dataJogo"])){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "ano":
				$inserido = $_POST['ano'];
				//pegando ano da data inserida
				$dataInserido = explode('-', $inserido);
				$anoInserido = $dataInserido[0];
				//pegando ano do jogo
				$dataJogo = explode('-', $row["dataJogo"]);
				$anoJogo = $dataJogo[0];
				if($anoInserido == $anoJogo){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "estadio":
				$inserido = $_POST['est'];
				if($inserido == utf8_encode($row["estadio"])){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "tecnico":
				$inserido = $_POST['tec'];
				if($inserido == utf8_encode($row["tecnico"])){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "numero":
				$numero = $numero + 1;
				$inserido = $_POST['num'];
				if($numero == $inserido){
					echo escreveLinha($numero, $row);
				}
				break;
				case "vitorias":
				$inserido = $_POST['vit'];
				if($row["golsBotafogo"] > $row["golsAdversario"]){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "empates":
				$inserido = $_POST['emp'];
				if($row["golsBotafogo"] == $row["golsAdversario"]){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
				case "derrotas":
				$inserido = $_POST['der'];
				if($row["golsBotafogo"] < $row["golsAdversario"]){
					$numero = $numero + 1;
					echo escreveLinha($numero, $row);
				}
				break;
			}
		}
		if($numero == 0){
			echo "<p>Nenhum jogo encontrado</p>";
		}
		echo "</table>";
	} else { echo "0 results"; }
	$conn->close();   
?>